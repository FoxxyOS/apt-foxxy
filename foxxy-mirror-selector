#!/bin/bash

function list() {
	echo -e "DEPRECATED

This is the old Foxxy Mirror Selector tool.

This software aimed at helping the selection of an APT mirror server
in older versions of Foxxy.

Nowadays the Foxxy images come with a pre-installed mirror redirector
that detects the location of the user (via geoip) and redirects its
requests to the nearest server available.

If you need to change your mirror repository, visit https://docs.foxxysec.org/doku.php/mirrors-list
and manually choose the best mirror for you.

Otherwise leave /etc/apt/sources.list empty
and put the following content in /etc/apt/sources.list.d/foxxy.list

	deb http://deb.foxxysec.org/foxxy stable main contrib non-free

"
}


branch="foxxy"
case $2 in
	stable)
		branch="foxxy"
	;;
	testing)
		branch="testing"
	;;
	foxxy)
		branch="foxxy"
	;;
	foxxy-testing)
		branch="testing"
	;;
esac

areas="main contrib non-free"
case $3 in
	nonfree)
		areas="main contrib non-free"
	;;
	free)
		areas="main"
	;;
esac

case $1 in
	list)
		list
	;;
	default)
		base="http://deb.foxxysec.org/foxxy/"
	;;
	0)
		base="http://archive.foxxysec.org/foxxy/"
	;;
	*)
		list
	;;
esac

if [ "$base" != "" ]; then
	if [ "$branch" != "" ]; then
		if [ "$areas" != "" ]; then
			echo "# foxxy repository" > /etc/apt/sources.list.d/foxxy.list
			echo "# this file was automatically generated by foxxy-mirror-selector" >> /etc/apt/sources.list.d/foxxy.list
			echo "deb $base $branch $areas" >> /etc/apt/sources.list.d/foxxy.list
			echo "#deb-src $base $branch $areas" >> /etc/apt/sources.list.d/foxxy.list
		fi
	fi
fi
